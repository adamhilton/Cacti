tinymce.ThemeManager.add("modern",function(n){function h(t,i){var u=[],r;if(t)return f(t.split(/[ ,]/),function(t){function o(){function r(n){return function(i,r){for(var u,f=r.parents.length;f--;)if(u=r.parents[f].nodeName,u=="OL"||u=="UL")break;t.active(i&&u==n)}}var i=n.selection;f=="bullist"&&i.selectorChanged("ul > li",r("UL"));f=="numlist"&&i.selectorChanged("ol > li",r("OL"));t.settings.stateSelector&&i.selectorChanged(t.settings.stateSelector,function(n){t.active(n)},!0);t.settings.disabledStateSelector&&i.selectorChanged(t.settings.disabledStateSelector,function(n){t.disabled(n)})}var f;if(t=="|")r=null;else if(e.has(t))t={type:t,size:i},u.push(t),r=null;else if(r||(r={type:"buttongroup",items:[]},u.push(r)),n.buttons[t])if(f=t,t=n.buttons[f],typeof t=="function"&&(t=t()),t.type=t.type||"button",t.size=i,t=e.create(t),r.items.push(t),n.initialized)o();else n.on("init",o)}),{type:"toolbar",layout:"flow",items:u}}function c(n){function u(t){if(t)return i.push(h(t,n)),!0}var i=[],r;if(tinymce.isArray(t.toolbar)){if(t.toolbar.length===0)return;tinymce.each(t.toolbar,function(n,i){t["toolbar"+(i+1)]=n});delete t.toolbar}for(r=1;r<10;r++)if(!u(t["toolbar"+r]))break;return i.length||t.toolbar===!1||u(t.toolbar||w),i.length?{type:"panel",layout:"stack",classes:"toolbar-grp",ariaRoot:!0,ariaRemember:!0,items:i}:void 0}function l(){function c(t){return t=="|"?{text:"|"}:n.menuItems[t]}function l(i){var o,e,r,h,l,u;if(l=tinymce.makeMap((t.removed_menuitems||"").split(/[ ,]/)),t.menu?(e=t.menu[i],h=!0):e=s[i],e){for(o={text:e.title},r=[],f((e.items||"").split(/[ ,]/),function(n){var t=c(n);t&&!l[n]&&r.push(c(n))}),h||f(n.menuItems,function(n){n.context==i&&(n.separator=="before"&&r.push({text:"|"}),n.prependToContext?r.unshift(n):r.push(n),n.separator=="after"&&r.push({text:"|"}))}),u=0;u<r.length;u++)r[u].text=="|"&&(u===0||u==r.length-1)&&r.splice(u,1);if(o.menu=r,!o.menu.length)return null}return o}var r,h=[],e=[],o,u,i;if(t.menu)for(r in t.menu)e.push(r);else for(r in s)e.push(r);for(o=typeof t.menubar=="string"?t.menubar.split(/[ ,]/):e,u=0;u<o.length;u++)i=o[u],i=l(i),i&&h.push(i);return h}function a(t){function i(n){var i=t.find(n)[0];i&&i.focus(!0)}n.shortcuts.add("Alt+F9","",function(){i("menubar")});n.shortcuts.add("Alt+F10","",function(){i("toolbar")});n.shortcuts.add("Alt+F11","",function(){i("elementpath")});t.on("cancel",function(){n.focus()})}function o(i,u){function h(n){return{width:n.clientWidth,height:n.clientHeight}}var e,f,o,s;e=n.getContainer();f=n.getContentAreaContainer().firstChild;o=h(e);s=h(f);i!==null&&(i=Math.max(t.min_width||100,i),i=Math.min(t.max_width||65535,i),r.setStyle(e,"width",i+(o.width-s.width)),r.setStyle(f,"width",i));u=Math.max(t.min_height||100,u);u=Math.min(t.max_height||65535,u);r.setStyle(f,"height",u);n.fire("ResizeEditor")}function b(t,r){var u=n.getContentAreaContainer();i.resizeTo(u.clientWidth+t,u.clientHeight+r)}function v(){function o(){return n.contextToolbars||[]}function p(t){var u,i,r;return u=tinymce.DOM.getPos(n.getContentAreaContainer()),i=n.dom.getRect(t),r=n.dom.getRoot(),r.nodeName=="BODY"&&(i.x-=r.ownerDocument.documentElement.scrollLeft||r.scrollLeft,i.y-=r.ownerDocument.documentElement.scrollTop||r.scrollTop),i.x+=u.x,i.y+=u.y,i}function w(){f(n.contextToolbars,function(n){n.panel&&n.panel.hide()})}function b(n,t,i){t=t?t.substr(0,2):"";f({t:"down",b:"up"},function(r,u){n.classes.toggle("arrow-"+r,i(u,t.substr(0,1)))});f({l:"left",r:"right"},function(r,u){n.classes.toggle("arrow-"+r,i(u,t.substr(1,1)))})}function s(n){return{left:n.x,top:n.y,width:n.w,height:n.h,right:n.x+n.w,bottom:n.y+n.h}}function c(n,i,r,u,f){return f=s({x:n,y:i,w:f.w,h:f.h}),t.inline_toolbar_position_handler&&(f=t.inline_toolbar_position_handler({elementRect:s(r),contentAreaRect:s(u),panelRect:f})),f}function l(n,t){n.moveTo(t.left,t.top)}function a(t){var o,f,i,r,e,s,h,a;if(!n.removed){if(!t||!t.toolbar.panel){w();return}h=["bc-tc","tc-bc","tl-bl","bl-tl","tr-br","br-tr"];e=t.toolbar.panel;e.show();i=p(t.element);f=tinymce.DOM.getRect(e.getEl());r=tinymce.DOM.getRect(n.getContentAreaContainer()||n.getBody());a=25;i.w=t.element.clientWidth;i.h=t.element.clientHeight;n.inline||(r.w=n.getDoc().documentElement.offsetWidth);n.selection.controlSelection.isResizable(t.element)&&i.w<a&&(i=u.inflate(i,0,8));o=u.findBestRelativePosition(f,i,r,h);i=u.clamp(i,r);o?(s=u.relativePosition(f,i,o),l(e,c(s.x,s.y,i,r,f))):(r.h+=f.h,i=u.intersect(r,i),i?(o=u.findBestRelativePosition(f,i,r,["bc-tc","bl-tl","br-tr"]),o?(s=u.relativePosition(f,i,o),l(e,c(s.x,s.y,i,r,f))):l(e,c(i.x,i.y,i,r,f))):e.hide());b(e,o,function(n,t){return n===t})}}function y(){function t(){n.selection&&a(r(n.selection.getNode()))}tinymce.util.Delay.requestAnimationFrame(t)}function k(){if(!i){i=n.selection.getScrollContainer()||n.getWin();tinymce.$(i).on("scroll",y);n.on("remove",function(){tinymce.$(i).off("scroll")})}}function d(t){var i;if(t.toolbar.panel){t.toolbar.panel.show();a(t);return}k();i=e.create({type:"floatpanel",role:"dialog",classes:"tinymce tinymce-inline arrow",ariaLabel:"Inline toolbar",layout:"flex",direction:"column",align:"stretch",autohide:!1,autofix:!0,fixed:!0,border:1,items:h(t.toolbar.items),oncancel:function(){n.focus()}});t.toolbar.panel=i;i.renderTo(document.body).reflow();a(t)}function v(){tinymce.each(o(),function(n){n.panel&&n.panel.hide()})}function r(t){for(var r,f=o(),u=n.$(t).parents().add(t),i=u.length-1;i>=0;i--)for(r=f.length-1;r>=0;r--)if(f[r].predicate(u[i]))return{toolbar:f[r],element:u[i]};return null}var i;n.on("click keyup setContent",function(t){(t.type!="setcontent"||t.selection)&&tinymce.util.Delay.setEditorTimeout(n,function(){var t;t=r(n.selection.getNode());t?(v(),d(t)):v()})});n.on("blur hide",v);n.on("ObjectResizeStart",function(){var t=r(n.selection.getNode());t&&t.toolbar.panel&&t.toolbar.panel.hide()});n.on("nodeChange ResizeEditor ResizeWindow",y);n.on("remove",function(){tinymce.each(o(),function(n){n.panel&&n.panel.remove()});n.contextToolbars={}});n.shortcuts.add("ctrl+shift+e > ctrl+shift+p","",function(){var t=r(n.selection.getNode());t&&t.toolbar.panel&&t.toolbar.panel.items()[0].focus()})}function y(n){return function(){if(n.initialized)n.fire("SkinLoaded");else n.on("init",function(){n.fire("SkinLoaded")})}}function k(u){function w(){var t,i;if(f&&f.moveRel&&f.visible()&&!f._fixed){var u=n.selection.getScrollContainer(),e=n.getBody(),o=0,s=0;u&&(t=r.getPos(e),i=r.getPos(u),o=Math.max(0,i.x-t.x),s=Math.max(0,i.y-t.y));f.fixed(!1).moveRel(e,n.rtl?["tr-br","br-tr"]:["tl-bl","bl-tl","tr-br"]).moveBy(o,s)}}function s(){f&&(f.show(),w(),r.addClass(n.getBody(),"mce-edit-focus"))}function b(){f&&(f.hide(),p.hideAll(),r.removeClass(n.getBody(),"mce-edit-focus"))}function h(){if(f){f.visible()||s();return}f=i.panel=e.create({type:o?"panel":"floatpanel",role:"application",classes:"tinymce tinymce-inline",layout:"flex",direction:"column",align:"stretch",autohide:!1,autofix:!0,fixed:!!o,border:1,items:[t.menubar===!1?null:{type:"menubar",border:"0 0 1 0",items:l()},c(t.toolbar_items_size)]});n.fire("BeforeRenderUI");f.renderTo(o||document.body).reflow();a(f);s();v();n.on("nodeChange",w);n.on("activate",s);n.on("deactivate",b);n.nodeChanged()}var f,o;t.fixed_toolbar_container&&(o=r.select(t.fixed_toolbar_container)[0]);t.content_editable=!0;n.on("focus",function(){u.skinUiCss?tinymce.DOM.styleSheetLoader.load(u.skinUiCss,h,h):h()});n.on("blur hide",b);n.on("remove",function(){f&&(f.remove(),f=null)});return u.skinUiCss&&tinymce.DOM.styleSheetLoader.load(u.skinUiCss,y(n)),{}}function d(r){function h(){return function(n){n.mode=="readonly"?u.find("*").disabled(!0):u.find("*").disabled(!1)}}var u,s,f;r.skinUiCss&&tinymce.DOM.styleSheetLoader.load(r.skinUiCss,y(n));u=i.panel=e.create({type:"panel",role:"application",classes:"tinymce",style:"visibility: hidden",layout:"stack",border:1,items:[t.menubar===!1?null:{type:"menubar",border:"0 0 1 0",items:l()},c(t.toolbar_items_size),{type:"panel",name:"iframe",layout:"stack",classes:"edit-area",html:"",border:"1 0 0 0"}]});t.resize!==!1&&(s={type:"resizehandle",direction:t.resize,onResizeStart:function(){var t=n.getContentAreaContainer().firstChild;f={width:t.clientWidth,height:t.clientHeight}},onResize:function(n){t.resize=="both"?o(f.width+n.deltaX,f.height+n.deltaY):o(null,f.height+n.deltaY)}});t.statusbar!==!1&&u.add({type:"panel",name:"statusbar",classes:"statusbar",layout:"flow",border:"1 0 0 0",ariaRoot:!0,items:[{type:"elementpath",editor:n},s]});n.fire("BeforeRenderUI");n.on("SwitchMode",h());u.renderBefore(r.targetNode).reflow();t.readonly&&n.setMode("readonly");t.width&&tinymce.DOM.setStyle(u.getEl(),"width",t.width);n.on("remove",function(){u.remove();u=null});return a(u),v(),{iframeContainer:u.find("#iframe")[0].getEl(),editorContainer:u.getEl()}}var i=this,t=n.settings,e=tinymce.ui.Factory,f=tinymce.each,r=tinymce.DOM,u=tinymce.geom.Rect,p=tinymce.ui.FloatPanel,s={file:{title:"File",items:"newdocument"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall"},insert:{title:"Insert",items:"|"},view:{title:"View",items:"visualaid |"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript | formats | removeformat"},table:{title:"Table"},tools:{title:"Tools"}},w="undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image";i.renderUI=function(r){var f=t.skin!==!1?t.skin||"lightgray":!1,u;f&&(u=t.skin_url,u=u?n.documentBaseURI.toAbsolute(u):tinymce.baseURL+"/skins/"+f,r.skinUiCss=tinymce.Env.documentMode<=7?u+"/skin.ie7.min.css":u+"/skin.min.css",n.contentCSS.push(u+"/content"+(n.inline?".inline":"")+".min.css"));n.on("ProgressState",function(n){i.throbber=i.throbber||new tinymce.ui.Throbber(i.panel.getEl("body"));n.state?i.throbber.show(n.time):i.throbber.hide()});return t.inline?k(r):d(r)};i.resizeTo=o;i.resizeBy=b});